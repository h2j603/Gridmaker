<!DOCTYPE html>

<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ê³ ê¸‰ ë°˜ì‘í˜• ê·¸ë¦¬ë“œ ì‹œìŠ¤í…œ</title>
<style>
* { box-sizing: border-box; margin: 0; padding: 0; }
body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #f5f5f5; padding: 20px; }
.container { max-width: 1800px; margin: 0 auto; background: white; border-radius: 12px; padding: 30px; box-shadow: 0 2px 20px rgba(0,0,0,0.08); }
.header { margin-bottom: 30px; padding-bottom: 20px; border-bottom: 2px solid #e5e7eb; }
.header h1 { color: #111827; font-size: 2em; margin-bottom: 8px; }
.view-toggle { display: flex; gap: 8px; margin-bottom: 20px; }
.view-btn { padding: 10px 20px; border: 2px solid #e5e7eb; border-radius: 6px; background: white; cursor: pointer; font-weight: 500; transition: all 0.2s; }
.view-btn.active { background: #3b82f6; color: white; border-color: #3b82f6; }
.workspace { display: grid; grid-template-columns: 320px 1fr 400px; gap: 30px; }
.panel { background: #f9fafb; border-radius: 8px; padding: 20px; }
.panel h3 { color: #111827; font-size: 0.95em; margin-bottom: 16px; font-weight: 600; }
.control-group { margin-bottom: 20px; padding-bottom: 16px; border-bottom: 1px solid #e5e7eb; }
.control-group:last-child { border-bottom: none; }
.control-label { display: block; color: #374151; font-size: 0.85em; font-weight: 500; margin-bottom: 6px; }
.control-input { width: 100%; padding: 8px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 14px; }
.input-group { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 8px; }
.btn { width: 100%; padding: 10px; border: none; border-radius: 6px; font-weight: 500; cursor: pointer; margin-bottom: 8px; font-size: 14px; }
.btn-primary { background: #3b82f6; color: white; }
.btn-primary:hover { background: #2563eb; }
.btn-secondary { background: #e5e7eb; color: #374151; }
.canvas { background: whitesmoke; border-radius: 8px; padding: 20px; min-height: 600px; transition: all 0.3s; }
.canvas.mobile-view { max-width: 375px; margin: 0 auto; }
.grid-container { display: grid; gap: 10px; min-height: 500px; }
.module { background: #8c6c3c; border-radius: 0; min-height: 60px; cursor: move; position: relative; border: 2px solid transparent; transition: all 0.2s; }
.module:hover { border-color: #3b82f6; transform: translateY(-2px); }
.module.selected { border-color: #ef4444; border-width: 3px; }
.module.dragging { opacity: 0.5; }
.module.warning { border-color: #f59e0b; border-width: 2px; }
.module-info { position: absolute; top: 4px; left: 4px; background: rgba(0,0,0,0.7); color: white; padding: 2px 6px; border-radius: 3px; font-size: 10px; font-weight: 600; }
.module-warning { position: absolute; top: 4px; right: 28px; background: rgba(245, 158, 11, 0.9); color: white; padding: 2px 6px; border-radius: 3px; font-size: 10px; font-weight: 600; }
.module-delete { position: absolute; top: 4px; right: 4px; width: 20px; height: 20px; background: rgba(239, 68, 68, 0.9); color: white; border: none; border-radius: 50%; cursor: pointer; display: none; font-size: 14px; }
.module:hover .module-delete { display: block; }
.stats { background: #eff6ff; padding: 12px; border-radius: 6px; margin-bottom: 16px; }
.stats-item { display: flex; justify-content: space-between; margin-bottom: 6px; font-size: 0.85em; }
.mode-selector { display: flex; flex-direction: column; gap: 8px; margin-top: 12px; }
.mode-option { padding: 10px; border: 2px solid #e5e7eb; border-radius: 6px; cursor: pointer; transition: all 0.2s; background: white; }
.mode-option:hover { border-color: #3b82f6; }
.mode-option.selected { border-color: #3b82f6; background: #eff6ff; }
.mode-option-title { font-weight: 600; font-size: 0.9em; margin-bottom: 4px; }
.mode-option-desc { font-size: 0.75em; color: #6b7280; }
.custom-offset { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-top: 8px; }
.mode-hint { font-size: 0.75em; color: #6b7280; margin-top: 6px; padding: 8px; background: #f0f9ff; border-radius: 4px; }
.hint-text { font-size: 0.75em; color: #6b7280; margin-top: 4px; }
.code-tabs { display: flex; gap: 8px; margin-bottom: 12px; border-bottom: 2px solid #e5e7eb; }
.code-tab { padding: 8px 16px; background: transparent; border: none; color: #6b7280; cursor: pointer; font-weight: 500; border-bottom: 2px solid transparent; margin-bottom: -2px; }
.code-tab.active { color: #3b82f6; border-bottom-color: #3b82f6; }
.code-display { background: #1e293b; color: #e2e8f0; padding: 16px; border-radius: 6px; font-family: 'Courier New', monospace; font-size: 12px; line-height: 1.6; max-height: 500px; overflow-y: auto; white-space: pre; }
.toast { position: fixed; bottom: 20px; right: 20px; background: #111827; color: white; padding: 12px 20px; border-radius: 8px; z-index: 1000; }
@media (max-width: 1400px) { .workspace { grid-template-columns: 1fr; } }
</style>
</head>
<body>

<div class="container">
  <div class="header">
    <h1>ğŸ“ ê³ ê¸‰ ë°˜ì‘í˜• ê·¸ë¦¬ë“œ ì‹œìŠ¤í…œ</h1>
    <p>ë¹„ìœ¨ ê¸°ë°˜ ìë™ ë³€í™˜ + ìˆ˜ë™ ì¡°ì • ê°€ëŠ¥</p>
  </div>

  <div class="view-toggle">
    <button class="view-btn active" onclick="switchView('desktop')">ğŸ–¥ï¸ ë°ìŠ¤í¬í†±</button>
    <button class="view-btn" onclick="switchView('mobile')">ğŸ“± ëª¨ë°”ì¼ í”„ë¦¬ë·°</button>
  </div>

  <div class="workspace">
    <div class="panel">
      <div class="control-group">
        <h3>ğŸ“Š ë°ìŠ¤í¬í†± ì„¤ì •</h3>
        <div class="stats">
          <div class="stats-item"><span>ì»¬ëŸ¼</span><span id="stat-columns">6ê°œ</span></div>
          <div class="stats-item"><span>ê°­</span><span id="stat-gap">10px</span></div>
          <div class="stats-item"><span>ëª¨ë“ˆ</span><span id="stat-modules">0ê°œ</span></div>
        </div>
        <label class="control-label">ì»¬ëŸ¼ ìˆ˜</label>
        <input type="number" id="columns" class="control-input" min="1" max="12" value="6">
        <label class="control-label" style="margin-top: 12px">ê°­ í¬ê¸° (px)</label>
        <input type="number" id="gap" class="control-input" min="0" max="50" value="10">
      </div>

```
  <div class="control-group">
    <h3>â• ì»¤ìŠ¤í…€ ëª¨ë“ˆ ì¶”ê°€</h3>
    <div class="input-group">
      <input type="number" id="custom-col" class="control-input" placeholder="ì»¬ëŸ¼" min="1" value="2">
      <input type="number" id="custom-row" class="control-input" placeholder="ë¡œìš°" min="1" value="2">
    </div>
    <label class="control-label" style="margin-top: 8px">ë°°ê²½ìƒ‰</label>
    <input type="color" id="custom-color" class="control-input" value="#8c6c3c" style="height: 40px; cursor: pointer;">
    <button class="btn btn-primary" onclick="addCustomModule()">ëª¨ë“ˆ ì¶”ê°€</button>
  </div>

  <div class="control-group" id="edit-panel" style="display: none;">
    <h3>âœï¸ ëª¨ë“ˆ í¸ì§‘</h3>
    <label class="control-label">ë°ìŠ¤í¬í†± ì»¬ëŸ¼ span</label>
    <input type="number" id="edit-col" class="control-input" min="1" max="12">
    <label class="control-label" style="margin-top: 12px">ë°ìŠ¤í¬í†± ë¡œìš° span</label>
    <input type="number" id="edit-row" class="control-input" min="1" max="10">
    <label class="control-label" style="margin-top: 12px">ëª¨ë°”ì¼ ì»¬ëŸ¼ span (ì„ íƒ)</label>
    <input type="number" id="edit-mobile-col" class="control-input" min="1" max="12" placeholder="ë¹„ì›Œë‘ë©´ ìë™">
    <div class="hint-text" id="mobile-span-hint">ìë™: ë¹„ìœ¨ ê³„ì‚°</div>
    <label class="control-label" style="margin-top: 12px">ë°°ê²½ìƒ‰</label>
    <input type="color" id="edit-color" class="control-input" style="height: 40px; cursor: pointer;">
    <button class="btn btn-secondary" style="margin-top: 12px" onclick="deleteSelected()">ğŸ—‘ï¸ ì‚­ì œ</button>
  </div>

  <div class="control-group">
    <h3>ğŸ“± ëª¨ë°”ì¼ ë°˜ì‘í˜• ëª¨ë“œ</h3>
    <label class="control-label">ëª¨ë°”ì¼ ëª©í‘œ ì»¬ëŸ¼ ìˆ˜</label>
    <input type="number" id="target-columns" class="control-input" min="1" max="12" value="2">
    
    <label class="control-label" style="margin-top: 12px">ë³€í™˜ ëª¨ë“œ</label>
    <div class="mode-selector">
      <div class="mode-option selected" onclick="selectMode('reflow')" data-mode="reflow">
        <div class="mode-option-title">ğŸ”„ ë¦¬í”Œë¡œìš°</div>
        <div class="mode-option-desc">ìˆœì„œëŒ€ë¡œ ì¬ë°°ì¹˜</div>
      </div>
      <div class="mode-option" onclick="selectMode('center')" data-mode="center">
        <div class="mode-option-title">â¬…ï¸â¡ï¸ ì¤‘ì•™ ìœ ì§€</div>
        <div class="mode-option-desc">ì–‘ë ê· ë“± ì œê±°</div>
      </div>
      <div class="mode-option" onclick="selectMode('left')" data-mode="left">
        <div class="mode-option-title">â¬…ï¸ ì™¼ìª½ ìœ ì§€</div>
        <div class="mode-option-desc">ì˜¤ë¥¸ìª½ë¶€í„° ì œê±°</div>
      </div>
      <div class="mode-option" onclick="selectMode('right')" data-mode="right">
        <div class="mode-option-title">â¡ï¸ ì˜¤ë¥¸ìª½ ìœ ì§€</div>
        <div class="mode-option-desc">ì™¼ìª½ë¶€í„° ì œê±°</div>
      </div>
      <div class="mode-option" onclick="selectMode('custom')" data-mode="custom">
        <div class="mode-option-title">âš™ï¸ ì»¤ìŠ¤í…€</div>
        <div class="mode-option-desc">ì˜¤í”„ì…‹ ì§ì ‘ ì„¤ì •</div>
      </div>
    </div>
    
    <div class="mode-hint" id="mode-hint">6ì—´ â†’ 2ì—´ë¡œ ë¦¬í”Œë¡œìš°</div>
    
    <div id="custom-offset-panel" style="display: none; margin-top: 12px;">
      <label class="control-label">ì»¤ìŠ¤í…€ ì˜¤í”„ì…‹</label>
      <div class="custom-offset">
        <input type="number" id="offset-left" class="control-input" placeholder="ì™¼ìª½ ì œê±°" min="0" value="2">
        <input type="number" id="offset-right" class="control-input" placeholder="ì˜¤ë¥¸ìª½ ì œê±°" min="0" value="2">
      </div>
    </div>
  </div>

  <div class="control-group">
    <button class="btn btn-secondary" onclick="clearAll()">ğŸ—‘ï¸ ì „ì²´ ì‚­ì œ</button>
  </div>
</div>

<div class="canvas" id="canvas">
  <div class="grid-container" id="grid"></div>
</div>

<div class="panel">
  <h3>ğŸ’» ìƒì„±ëœ ì½”ë“œ</h3>
  <div class="code-tabs">
    <button class="code-tab active" onclick="switchTab('html', event)">HTML</button>
    <button class="code-tab" onclick="switchTab('css', event)">CSS</button>
  </div>
  <div class="code-display" id="code-display"></div>
  <button class="btn btn-primary" style="margin-top: 12px" onclick="copyCode()">ğŸ“‹ í´ë¦½ë³´ë“œì— ë³µì‚¬</button>
</div>
```

  </div>
</div>

<div id="toast" class="toast" style="display: none;"></div>

<script>
let modules = [];
let desktopColumns = 6, desktopGap = 10;
let targetColumns = 2, mobileGap = 10;
let responsiveMode = 'reflow';
let customOffsetLeft = 2, customOffsetRight = 2;
let currentView = 'desktop', selectedModule = null, activeTab = 'html', draggedIndex = null;
let desktopOrder = [], mobileOrder = [];

function calculateMobileSpan(desktopCol, desktopCols, targetCols) {
  // ë¹„ìœ¨ ê³„ì‚°: (desktopCol / desktopCols) * targetCols
  const ratio = desktopCol / desktopCols;
  const calculated = Math.round(ratio * targetCols);
  // ìµœì†Œ 1, ìµœëŒ€ targetCols
  return Math.max(1, Math.min(calculated, targetCols));
}

function getMobileSpan(module) {
  // ìˆ˜ë™ ì„¤ì •ì´ ìˆìœ¼ë©´ ê·¸ê²ƒ ì‚¬ìš©, ì—†ìœ¼ë©´ ìë™ ê³„ì‚°
  if(module.mobileCol !== undefined && module.mobileCol !== null && module.mobileCol !== '') {
    return Math.min(module.mobileCol, targetColumns);
  }
  return calculateMobileSpan(module.col, desktopColumns, targetColumns);
}

function switchView(view) {
  currentView = view;
  document.querySelectorAll('.view-btn').forEach(btn => btn.classList.remove('active'));
  event.target.classList.add('active');
  document.getElementById('canvas').classList.toggle('mobile-view', view === 'mobile');
  render();
}

function selectMode(mode) {
  responsiveMode = mode;
  document.querySelectorAll('.mode-option').forEach(opt => opt.classList.remove('selected'));
  document.querySelector(`[data-mode="${mode}"]`).classList.add('selected');
  document.getElementById('custom-offset-panel').style.display = mode === 'custom' ? 'block' : 'none';
  updateModeHint();
  updateCode();
  showToast(getModeLabel(mode) + ' ëª¨ë“œ');
}

function getModeLabel(mode) {
  return {'reflow':'ë¦¬í”Œë¡œìš°','center':'ì¤‘ì•™ ìœ ì§€','left':'ì™¼ìª½ ìœ ì§€','right':'ì˜¤ë¥¸ìª½ ìœ ì§€','custom':'ì»¤ìŠ¤í…€'}[mode];
}

function updateModeHint() {
  const hint = document.getElementById('mode-hint');
  const removed = desktopColumns - targetColumns;
  
  if(responsiveMode === 'reflow') {
    hint.textContent = `${desktopColumns}ì—´ â†’ ${targetColumns}ì—´ë¡œ ë¦¬í”Œë¡œìš°`;
  } else if(responsiveMode === 'center') {
    const eachSide = Math.floor(removed / 2);
    hint.textContent = `${desktopColumns}ì—´ â†’ ${targetColumns}ì—´ (ì–‘ë ${eachSide}ê°œì”© ì œê±°)`;
  } else if(responsiveMode === 'left') {
    hint.textContent = `${desktopColumns}ì—´ â†’ ${targetColumns}ì—´ (ì˜¤ë¥¸ìª½ ${removed}ê°œ ì œê±°)`;
  } else if(responsiveMode === 'right') {
    hint.textContent = `${desktopColumns}ì—´ â†’ ${targetColumns}ì—´ (ì™¼ìª½ ${removed}ê°œ ì œê±°)`;
  } else if(responsiveMode === 'custom') {
    const total = desktopColumns - customOffsetLeft - customOffsetRight;
    hint.textContent = `${desktopColumns}ì—´ â†’ ${total}ì—´ (ì™¼ìª½ ${customOffsetLeft}, ì˜¤ë¥¸ìª½ ${customOffsetRight} ì œê±°)`;
  }
}

function updateMobileSpanHint() {
  if(selectedModule === null) return;
  const m = modules[selectedModule];
  const auto = calculateMobileSpan(m.col, desktopColumns, targetColumns);
  const hint = document.getElementById('mobile-span-hint');
  hint.textContent = `ìë™: ${auto}ì—´ (${m.col}/${desktopColumns} Ã— ${targetColumns})`;
}

function init() {
  document.getElementById('columns').addEventListener('input', e => { 
    desktopColumns = parseInt(e.target.value) || 1; 
    updateStats(); updateModeHint(); updateMobileSpanHint(); render(); 
  });
  document.getElementById('gap').addEventListener('input', e => { desktopGap = parseInt(e.target.value) || 0; updateStats(); render(); });
  document.getElementById('target-columns').addEventListener('input', e => { 
    targetColumns = parseInt(e.target.value) || 1; 
    updateModeHint(); updateMobileSpanHint(); updateCode(); render();
  });
  document.getElementById('offset-left').addEventListener('input', e => { customOffsetLeft = parseInt(e.target.value) || 0; updateModeHint(); updateCode(); });
  document.getElementById('offset-right').addEventListener('input', e => { customOffsetRight = parseInt(e.target.value) || 0; updateModeHint(); updateCode(); });
  document.getElementById('edit-col').addEventListener('input', e => { 
    if(selectedModule!==null) { 
      modules[selectedModule].col = parseInt(e.target.value)||1; 
      updateMobileSpanHint();
      render(); 
    }
  });
  document.getElementById('edit-row').addEventListener('input', e => { if(selectedModule!==null) { modules[selectedModule].row = parseInt(e.target.value)||1; render(); }});
  document.getElementById('edit-mobile-col').addEventListener('input', e => { 
    if(selectedModule!==null) { 
      const val = e.target.value;
      modules[selectedModule].mobileCol = val === '' ? null : parseInt(val);
      render(); 
    }
  });
  document.getElementById('edit-color').addEventListener('input', e => { if(selectedModule!==null) { modules[selectedModule].color = e.target.value; render(); }});
  updateStats(); updateModeHint(); render();
}

function addCustomModule() {
  const col = parseInt(document.getElementById('custom-col').value) || 2;
  const row = parseInt(document.getElementById('custom-row').value) || 2;
  const color = document.getElementById('custom-color').value;
  const newModule = { col, row, color, mobileCol: null, id: Date.now() };
  modules.push(newModule);
  desktopOrder.push(newModule.id);
  mobileOrder.push(newModule.id);
  showToast(`${col}Ã—${row} ëª¨ë“ˆ ì¶”ê°€`);
  render();
}

function selectModule(index) {
  selectedModule = index;
  const m = modules[index];
  document.getElementById('edit-panel').style.display = 'block';
  document.getElementById('edit-col').value = m.col;
  document.getElementById('edit-row').value = m.row;
  document.getElementById('edit-mobile-col').value = m.mobileCol !== null ? m.mobileCol : '';
  document.getElementById('edit-color').value = m.color || '#8c6c3c';
  updateMobileSpanHint();
  render();
}

function deleteSelected() {
  if(selectedModule !== null) {
    const id = modules[selectedModule].id;
    modules.splice(selectedModule, 1);
    desktopOrder = desktopOrder.filter(oid => oid !== id);
    mobileOrder = mobileOrder.filter(oid => oid !== id);
    selectedModule = null;
    document.getElementById('edit-panel').style.display = 'none';
    showToast('ëª¨ë“ˆ ì‚­ì œ');
    render();
  }
}

function deleteModule(index, event) {
  event.stopPropagation();
  const id = modules[index].id;
  modules.splice(index, 1);
  desktopOrder = desktopOrder.filter(oid => oid !== id);
  mobileOrder = mobileOrder.filter(oid => oid !== id);
  if(selectedModule === index) {
    selectedModule = null;
    document.getElementById('edit-panel').style.display = 'none';
  } else if(selectedModule > index) selectedModule--;
  render();
}

function clearAll() {
  if(confirm('ëª¨ë“  ëª¨ë“ˆì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
    modules = [];
    desktopOrder = [];
    mobileOrder = [];
    selectedModule = null;
    document.getElementById('edit-panel').style.display = 'none';
    showToast('ì „ì²´ ì‚­ì œ');
    render();
  }
}

function handleDragStart(index, event) {
  draggedIndex = index;
  event.target.classList.add('dragging');
}

function handleDragEnd(event) {
  event.target.classList.remove('dragging');
  draggedIndex = null;
}

function handleDragOver(event) {
  event.preventDefault();
}

function handleDrop(index, event) {
  event.preventDefault();
  if(draggedIndex !== null && draggedIndex !== index) {
    const order = currentView === 'desktop' ? desktopOrder : mobileOrder;
    const draggedId = order[draggedIndex];
    order.splice(draggedIndex, 1);
    order.splice(index, 0, draggedId);
    
    if(selectedModule === draggedIndex) selectedModule = index;
    else if(selectedModule === index) selectedModule = draggedIndex < index ? index-1 : index+1;
    
    render();
  }
}

function getOrderedModules() {
  const order = currentView === 'desktop' ? desktopOrder : mobileOrder;
  return order.map(id => modules.find(m => m.id === id)).filter(m => m);
}

function updateStats() {
  document.getElementById('stat-columns').textContent = `${desktopColumns}ê°œ`;
  document.getElementById('stat-gap').textContent = `${desktopGap}px`;
  document.getElementById('stat-modules').textContent = `${modules.length}ê°œ`;
}

function render() {
  const grid = document.getElementById('grid');
  const columns = currentView === 'desktop' ? desktopColumns : targetColumns;
  const gap = currentView === 'desktop' ? desktopGap : mobileGap;
  grid.style.gridTemplateColumns = `repeat(${columns}, 1fr)`;
  grid.style.gap = `${gap}px`;
  
  const orderedModules = getOrderedModules();
  
  grid.innerHTML = orderedModules.map((m, i) => {
    const actualIndex = modules.findIndex(mod => mod.id === m.id);
    const bgColor = m.color || '#8c6c3c';
    const col = currentView === 'desktop' ? m.col : getMobileSpan(m);
    const showWarning = currentView === 'mobile' && m.col > targetColumns && m.mobileCol === null;
    
    return `
    <div class="module ${selectedModule === actualIndex ? 'selected' : ''} ${showWarning ? 'warning' : ''}" 
         style="grid-column: span ${col}; grid-row: span ${m.row}; background: ${bgColor}"
         onclick="selectModule(${actualIndex})"
         draggable="true"
         ondragstart="handleDragStart(${i}, event)"
         ondragend="handleDragEnd(event)"
         ondragover="handleDragOver(event)"
         ondrop="handleDrop(${i}, event)">
      <div class="module-info">${m.col}Ã—${m.row}</div>
      ${showWarning ? '<div class="module-warning">!</div>' : ''}
      <button class="module-delete" onclick="deleteModule(${actualIndex}, event)">Ã—</button>
    </div>
  `}).join('');
  updateStats(); updateCode();
}

function generateHTML() {
  return `<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="grid-container">
${desktopOrder.map((id, i) => `    <div class="module module-${i + 1}"></div>`).join('\n')}
  </div>
</body>
</html>`;
}

function generateCSS() {
  let css = `body {
  margin: 0;
  background: whitesmoke;
  padding: ${desktopGap}px;
}

.grid-container {
  display: grid;
  grid-template-columns: repeat(${desktopColumns}, 1fr);
  gap: ${desktopGap}px;
}

.module {
  min-height: 60px;
}

${desktopOrder.map((id, i) => {
  const m = modules.find(mod => mod.id === id);
  return `.module-${i + 1} {
  grid-column: span ${m.col};
  grid-row: span ${m.row};
  background: ${m.color || '#8c6c3c'};
}`;
}).join('\n\n')}

/* ëª¨ë°”ì¼ ë°˜ì‘í˜• - ${getModeLabel(responsiveMode)} */
@media (max-width: 768px) {
  body { padding: ${mobileGap}px; }
  .grid-container {
    grid-template-columns: repeat(${targetColumns}, 1fr);
    gap: ${mobileGap}px;
  }
  
`;

  if(responsiveMode === 'custom') {
    const actualCols = desktopColumns - customOffsetLeft - customOffsetRight;
    css += `  /* ì™¼ìª½ ${customOffsetLeft}ê°œ, ì˜¤ë¥¸ìª½ ${customOffsetRight}ê°œ ì œê±° â†’ ${actualCols}ì—´ */\n`;
  } else if(responsiveMode === 'center') {
    const removed = desktopColumns - targetColumns;
    const each = Math.floor(removed / 2);
    css += `  /* ì–‘ë ${each}ê°œì”© ì œê±° â†’ ${targetColumns}ì—´ */\n`;
  } else if(responsiveMode === 'left') {
    const removed = desktopColumns - targetColumns;
    css += `  /* ì˜¤ë¥¸ìª½ ${removed}ê°œ ì œê±° â†’ ${targetColumns}ì—´ */\n`;
  } else if(responsiveMode === 'right') {
    const removed = desktopColumns - targetColumns;
    css += `  /* ì™¼ìª½ ${removed}ê°œ ì œê±° â†’ ${targetColumns}ì—´ */\n`;
  }

  css += mobileOrder.map((id, i) => {
    const m = modules.find(mod => mod.id === id);
    const mobileSpan = getMobileSpan(m);
    const comment = m.mobileCol !== null ? ' /* ìˆ˜ë™ ì„¤ì • */' : ` /* ìë™: ${m.col}/${desktopColumns} Ã— ${targetColumns} = ${mobileSpan} */`;
    return `  .module-${desktopOrder.indexOf(id) + 1} {
    grid-column: span ${mobileSpan};${comment}
    grid-row: span ${m.row};
    order: ${i};
  }`;
  }).join('\n\n');

  css += '\n}';
  return css;
}

function updateCode() {
  document.getElementById('code-display').textContent = activeTab === 'html' ? generateHTML() : generateCSS();
}

function switchTab(tab, event) {
  activeTab = tab;
  document.querySelectorAll('.code-tab').forEach(t => t.classList.remove('active'));
  event.target.classList.add('active');
  updateCode();
}

function copyCode() {
  navigator.clipboard.writeText(activeTab === 'html' ? generateHTML() : generateCSS());
  showToast(`${activeTab.toUpperCase()} ì½”ë“œ ë³µì‚¬ë¨!`);
}

function showToast(message) {
  const toast = document.getElementById('toast');
  toast.textContent = message;
  toast.style.display = 'block';
  setTimeout(() => toast.style.display = 'none', 3000);
}

window.addEventListener('DOMContentLoaded', init);
</script>

</body>
</html>
